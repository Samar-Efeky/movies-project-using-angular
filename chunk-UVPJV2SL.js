import{a as q}from"./chunk-4BRIQQKH.js";import{a as G}from"./chunk-CVUVDL7G.js";import{a as j,k as z,l as H,m as Q,n as L,o as N,p as Y}from"./chunk-GI6Z5HJX.js";import{$ as m,$a as $,D as x,Da as w,Ea as D,Fa as P,H as n,Ja as A,K as g,M,Ra as B,Ta as R,V as E,W as d,X as c,Z as y,_ as I,aa as o,ba as r,bb as U,ca as _,ga as C,i as V,ia as h,ka as a,l as T,la as O,ma as k,na as F,ra as p,rb as J,sa as S,ta as v,v as u,w as f}from"./chunk-U6OHNGF4.js";var W=["swiperContainer"];function X(i,t){if(i&1){let e=C();o(0,"a",18),h("click",function(){u(e);let s=a(2);return f(s.toggleBiography())}),p(1),r()}if(i&2){let e=a(2);n(),v(" ",e.showFullBiography?"See Less":"See More"," ")}}function Z(i,t){if(i&1){let e=C();o(0,"div")(1,"div",12)(2,"div",13)(3,"img",14),h("visible",function(){u(e);let s=a();return f(s.overviewVisible=!0)}),r()(),o(4,"div",15)(5,"h2",5),h("visible",function(){u(e);let s=a();return f(s.overviewVisible=!0)}),p(6),r(),o(7,"p",16),p(8),w(9,"seeMore"),d(10,X,2,1,"a",17),r(),o(11,"h4"),p(12,"Birthday:"),r(),o(13,"p"),p(14),w(15,"date"),r(),o(16,"h4",5),h("visible",function(){u(e);let s=a();return f(s.overviewVisible=!0)}),p(17," Place of Birth:"),r(),o(18,"p"),p(19),r()()()()}if(i&2){let e=a();n(3),m("@zoomIn",e.overviewVisible?"visible":"void")("src","https://image.tmdb.org/t/p/w500"+(e.personDetails==null?null:e.personDetails.profile_path),x),n(2),m("@slideDown",e.overviewVisible?"visible":"void"),n(),v(" ",e.personDetails==null?null:e.personDetails.name," "),n(2),v(" ",e.showFullBiography?e.personDetails==null?null:e.personDetails.biography:P(9,9,e.personDetails==null?null:e.personDetails.biography,50)," "),n(2),c(e.shouldShowToggle(e.personDetails==null?null:e.personDetails.biography)?10:-1),n(4),v(" ",P(15,12,e.personDetails==null?null:e.personDetails.birthday,"longDate")),n(2),m("@slideUp",e.overviewVisible?"visible":"void"),n(3),v(" ",e.personDetails==null?null:e.personDetails.place_of_birth)}}function ee(i,t){if(i&1&&_(0,"img",22),i&2){let e=t.$implicit;m("src","https://image.tmdb.org/t/p/w500"+e.file_path,x)}}function ie(i,t){if(i&1){let e=C();o(0,"div",23)(1,"button",24),h("click",function(){u(e);let s=a(2);return f(s.toggleImagesView())}),p(2),r()()}if(i&2){let e=a(2);n(2),v(" ",e.showAllImages?"See Less":"See More"," ")}}function te(i,t){if(i&1){let e=C();o(0,"div",3)(1,"h3",19),h("visible",function(){u(e);let s=a();return f(s.overviewVisible=!0)}),_(2,"i",20),p(3," Images"),r(),o(4,"div",21),y(5,ee,1,1,"img",22,E().trackByFn,!0),r(),d(7,ie,3,1,"div",23),r()}if(i&2){let e=a();n(),m("@slideDown",e.overviewVisible?"visible":"void"),n(4),I(e.visibleImages),n(2),c(e.personImages.length>10?7:-1)}}function ne(i,t){if(i&1&&_(0,"img",28),i&2){let e=a(2).$implicit;m("src","https://image.tmdb.org/t/p/w500"+e.profile_path,x)}}function oe(i,t){if(i&1&&_(0,"img",29),i&2){let e=a(2).$implicit;m("src","https://image.tmdb.org/t/p/w500"+e.poster_path,x)}}function re(i,t){if(i&1&&(o(0,"button",30),p(1),r()),i&2){let e=a(2).$implicit;n(),v(" ",e.vote_average," ")}}function se(i,t){if(i&1&&(o(0,"p"),p(1),w(2,"seeMore"),r()),i&2){let e=a(2).$implicit;n(),S(P(2,1,e.name,1))}}function ae(i,t){if(i&1&&(o(0,"p"),p(1),w(2,"seeMore"),r()),i&2){let e=a(2).$implicit;n(),S(P(2,1,e.title,1))}}function le(i,t){if(i&1&&(o(0,"p")(1,"span",31),_(2,"i",32),p(3),w(4,"timeAgo"),r()()),i&2){let e=a(2).$implicit;n(3),v(" ",D(4,1,e.release_date))}}function pe(i,t){if(i&1&&(o(0,"p")(1,"span",31),_(2,"i",32),p(3),w(4,"timeAgo"),r()()),i&2){let e=a(2).$implicit;n(3),v(" ",D(4,1,e.first_air_date))}}function de(i,t){if(i&1){let e=C();o(0,"div",26),h("click",function(){u(e);let s=a().$implicit,b=a();return f(b.goToMediaDetails(s.media_type,s.id))}),o(1,"div",27),d(2,ne,1,1,"img",28),d(3,oe,1,1,"img",29),d(4,re,2,1,"button",30),r(),d(5,se,3,4,"p"),d(6,ae,3,4,"p"),d(7,le,5,3,"p"),d(8,pe,5,3,"p"),r()}if(i&2){let e=a().$implicit;n(2),c(e.profile_path?2:-1),n(),c(e.poster_path?3:-1),n(),c(e.vote_average?4:-1),n(),c(e.name?5:-1),n(),c(e.title?6:-1),n(),c(e.release_date?7:-1),n(),c(e.first_air_date?8:-1)}}function ce(i,t){if(i&1&&d(0,de,9,7,"div",25),i&2){let e=t.$implicit;c(e.poster_path&&e.first_air_date||e.poster_path&&e.release_date?0:-1)}}var K=class i{constructor(t,e,l,s,b,me){this._MediaDetailsService=t;this.route=e;this._Router=l;this.cd=s;this.profileService=b;this.userService=me}overviewVisible=!1;showFullBiography=!1;showAllImages=!1;type;id;personDetails=null;personImages=[];visibleImages=[];personCredits=[];visibleItems={};swiperInstance;swiperTimeout;sub;uid="";swiperContainer;ngOnInit(){this.userService.currentUser$.pipe(T(1)).subscribe(t=>{t&&(this.uid=t.uid)}),this.sub=this.route.paramMap.subscribe(t=>{this.type=t.get("mediaType")||"",this.id=t.get("mediaId")||"",V({details:this._MediaDetailsService.getMediaDetails(this.type,this.id),images:this._MediaDetailsService.getMostDetails(this.type,this.id,"images"),personCredits:this._MediaDetailsService.getMostDetails(this.type,this.id,"combined_credits")}).subscribe({next:({details:e,images:l,personCredits:s})=>{this.personDetails=e,this.uid&&this.personDetails&&this.addToHistory(),this.personImages=l.profiles||[],this.visibleImages=this.personImages.slice(0,10),this.personCredits=s.cast||[],this.swiperTimeout=setTimeout(()=>{this.personCredits.length>=2&&(this.initSwiper(),this.cd.detectChanges())},0)}})})}trackByFn(t,e){return e.file_path||t}trackMediaPerson(t,e){return`${e.credit_id||e.id||t}-${e.media_type}`}ngAfterViewInit(){this.swiperTimeout=setTimeout(()=>{this.personCredits.length>=2&&this.initSwiper()},0)}ngOnDestroy(){this.sub?.unsubscribe(),this.swiperTimeout&&clearTimeout(this.swiperTimeout),this.swiperInstance&&typeof this.swiperInstance.destroy=="function"&&(this.swiperInstance.destroy(!0,!0),this.swiperInstance=null,console.log("Swiper destroyed \u2705"))}toggleBiography(){this.showFullBiography=!this.showFullBiography}shouldShowToggle(t){return t?.split(" ").length>40}toggleImagesView(){this.showAllImages=!this.showAllImages,this.visibleImages=this.showAllImages?this.personImages:this.personImages.slice(0,10)}initSwiper(){if(!this.personCredits||this.personCredits.length<2)return;this.swiperInstance&&typeof this.swiperInstance.destroy=="function"&&(this.swiperInstance.destroy(!0,!0),this.swiperInstance=null);let t=Math.min(5,this.personCredits.length);this.swiperInstance=new Swiper(this.swiperContainer.nativeElement,{loop:this.personCredits.length>t,slidesPerView:t,spaceBetween:20,autoplay:{delay:2500,disableOnInteraction:!1},navigation:{nextEl:".custom-next",prevEl:".custom-prev"},breakpoints:{0:{slidesPerView:2},500:{slidesPerView:3},700:{slidesPerView:4},1e3:{slidesPerView:3},1150:{slidesPerView:4},1500:{slidesPerView:Math.min(5,this.personCredits.length)}}}),console.log("Swiper instance initialized \u2705")}goToMediaDetails(t,e){t==="person"?this._Router.navigate(["person-details",t,e]):this._Router.navigate(["media-details",t,e])}addToHistory(){this.uid&&this.profileService.addToHistory(this.uid,{id:this.personDetails.id,title:this.personDetails.name,imageUrl:this.personDetails.profile_path?"https://image.tmdb.org/t/p/w500/"+this.personDetails.profile_path:"",type:"person"}).then(()=>{console.log("\u062A\u0645\u062A \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0625\u0644\u0649 history")})}static \u0275fac=function(e){return new(e||i)(g(G),g($),g(U),g(A),g(Y),g(J))};static \u0275cmp=M({type:i,selectors:[["app-person-profile"]],viewQuery:function(e,l){if(e&1&&O(W,5),e&2){let s;k(s=F())&&(l.swiperContainer=s.first)}},decls:17,vars:5,consts:[["swiperContainer",""],[3,"page"],[1,"person-profile","mt-5"],[1,"my-3","overflow-hidden"],[1,"py-3","overflow-hidden"],["appAnimateOnVisible","",3,"visible"],[1,"fa-solid","fa-play","fa-1x"],[1,"swiper","position-relative"],[1,"swiper-navigation"],[1,"swiper-button-prev","custom-prev"],[1,"swiper-button-next","custom-next"],[1,"swiper-wrapper"],[1,"row"],[1,"col-lg-3","col-md-4","col-12"],["appAnimateOnVisible","","alt","Person Image","height","350",1,"img-fluid","rounded-3","w-100",3,"visible","src"],[1,"col-lg-9","col-md-8","col-12","py-2","overflow-hidden"],[1,"py-2"],["role","button",1,"text-primary","ms-2"],["role","button",1,"text-primary","ms-2",3,"click"],["appAnimateOnVisible","",1,"py-2",3,"visible"],[1,"fa-solid","fa-camera","fa-1x"],[1,"w-100","d-flex","justify-content-center","flex-wrap","gap-3","py-3"],["width","100","alt","Image",1,"img-fluid","rounded-3",3,"src"],[1,"text-center","py-2"],[1,"text-white","px-2","py-1","button-mix-color",3,"click"],[1,"swiper-slide","slider-container","rounded-3"],[1,"swiper-slide","slider-container","rounded-3",3,"click"],[1,"position-relative"],["alt","Person Image",1,"rounded-3",3,"src"],["alt","mediaPerson Poster",1,"rounded-3",3,"src"],[1,"vote","p-1","rounded-3","border-0","fw-bolder","text-white","position-absolute","top-0","end-0"],[1,"date-media"],[1,"fa-solid","fa-clock","text-white"]],template:function(e,l){if(e&1){let s=C();_(0,"app-main-header-page",1),o(1,"section")(2,"div",2),d(3,Z,20,15,"div"),d(4,te,8,2,"div",3),o(5,"div",4)(6,"h3",5),h("visible",function(){return u(s),f(l.overviewVisible=!0)}),_(7,"i",6),p(8," Movies & TV Shows "),r()(),o(9,"div",7,0)(11,"div",8),_(12,"button",9)(13,"button",10),r(),o(14,"div",11),y(15,ce,1,1,null,null,l.trackMediaPerson,!0),r()()()()}e&2&&(m("page",l.personDetails==null?null:l.personDetails.name),n(3),c(l.personDetails?3:-1),n(),c(l.personImages?4:-1),n(2),m("@slideDown",l.overviewVisible?"visible":"void"),n(3),m("@slideUp",void 0),n(6),I(l.personCredits))},dependencies:[q,R,L,B,j,N],styles:["i[_ngcontent-%COMP%]{color:var(--main-color)}.swiper-navigation[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;z-index:20;display:flex;justify-content:space-between;transform:translateY(-50%);pointer-events:none}.swiper-button-prev[_ngcontent-%COMP%], .swiper-button-next[_ngcontent-%COMP%]{pointer-events:all;background-color:#0009;border:none;color:#fff;padding:25px;cursor:pointer;transition:background-color .3s ease}.slider-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:250px;width:100%}@media screen and (max-width:1300px){.slider-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:180px}}@media screen and (max-width:500px){.slider-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}}"],data:{animation:[H,Q,z]}})};export{K as PersonProfileComponent};
