<!-- Main header displaying media type and category -->
@if (mediaType && category) {
  <app-main-header-page id="media-section"
    [mediaType]="mediaType"
    [category]="category">
  </app-main-header-page>
}
<section>
  <div class="mt-5">
    <!-- Container holding all media cards -->
    <div class="media-container-parent w-100">
      <!-- Loop through paginated media list -->
      @for (mediaContainer of paginatedMedia; track trackMedia($index,mediaContainer); let i = $index) {
        @if (mediaContainer.profile_path||mediaContainer.poster_path) {
          <div class="overflow-hidden" appAnimateOnVisible (visible)="markAsVisible(i)"
            >
            <!-- Single media card -->
            <div class="media-container p-3"
              (click)="goToMediaDetails(mediaType === 'trending' ? mediaContainer.media_type : mediaType, mediaContainer.id)">
              <div class="position-relative">
                <!-- Profile image if available (used for people) -->
                @if (mediaContainer.profile_path) {
                  <img [@zoomIn]="visibleItems[i]?'visible':'void'"
                    [src]="'https://image.tmdb.org/t/p/w500' + mediaContainer.profile_path"
                    alt="Person Image" />
                  }
                  <!-- Poster image if available (used for movies/series) -->
                  @if (mediaContainer.poster_path) {
                    <img  [@zoomIn]="visibleItems[i]?'visible':'void'"
                      [src]="'https://image.tmdb.org/t/p/w500' + mediaContainer.poster_path"
                      alt="mediaContainer Poster" />
                    }
                    <!-- Vote average shown as a badge -->
                    @if (mediaContainer.vote_average) {
                      <button  [@zoomIn]="visibleItems[i]?'visible':'void'"
                        class="vote p-1 rounded-0 border-0 fw-bolder text-white position-absolute top-0 end-0">
                        {{ mediaContainer.vote_average }}
                      </button>
                    }
                  </div>
                  <div class="overflow-hidden py-2">
                    <!-- Media name (for person) -->
                    @if (mediaContainer.name) {
                      <p [@slideDown]="visibleItems[i]?'visible':'void'"  >
                        {{ mediaContainer.name | seeMore: 2 }}
                      </p>
                    }
                    <!-- Media title (for movies/shows) -->
                    @if (mediaContainer.title) {
                      <p [@slideDown]="visibleItems[i]?'visible':'void'"  >
                        {{ mediaContainer.title | seeMore: 2 }}
                      </p>
                    }
                    <!-- date -->
                    @if (mediaContainer.release_date) {
                      <p [@slideUp]="visibleItems[i]?'visible': 'void'">
                        <span class="date-media">{{ mediaContainer.release_date|timeAgo }}</span>
                      </p>
                    }
                    @if (mediaContainer.first_air_date) {
                      <p [@slideUp]="visibleItems[i]?'visible': 'void'">
                        <span class="date-media">{{ mediaContainer.first_air_date|timeAgo }}</span>
                      </p>
                    }
                    @if (mediaContainer.popularity && mediaType==='person') {
                      <p [@slideUp]="visibleItems[i]?'visible': 'void'">
                        popularity:
                        <span class="popularity">{{ mediaContainer.popularity }}</span>
                      </p>
                    }
                  </div>
                </div>
              </div>
            }
          }
        </div>

        <!-- Pagination controls -->
        <div class="pagination d-flex justify-content-center mt-5 gap-2 flex-wrap">

          <!-- Previous button -->
          <button
            [disabled]="currentPage === 1"
            (click)="changePage(currentPage - 1)">
            &lt;
          </button>

          <!-- Smart dynamic pagination -->
          @for (page of smartPagination; track page) {
            <!-- Page number button -->
            @if (isNumber(page)) {
              <button
                [ngClass]="{'active-page': currentPage === page}"
                [disabled]="currentPage === page"
                (click)="changePage(page)">
                {{ page }}
              </button>
            }
            <!-- Ellipsis for skipped pages -->
            @else {
            <button disabled>...</button>
          }
        }

        <!-- Next button -->
        <button
          [disabled]="currentPage === totalPages"
          (click)="changePage(currentPage + 1)">
          &gt;
        </button>
      </div>

    </div>
  </section>
