<app-main-header-page [page]="personDetails?.name"></app-main-header-page>
<section>
  <div class="person-profile mt-5">
    @if (personDetails) {
      <div >
        <div class="row ">
          <div class="col-lg-3 col-md-4 col-12">
            <img [@zoomIn]="overviewVisible ? 'visible' : 'void'"
              appAnimateOnVisible (visible)="overviewVisible = true"
              [src]="'https://image.tmdb.org/t/p/w500' + personDetails?.profile_path"
              alt="Person Image" class="img-fluid rounded-3 w-100"  height="350">
            </div>
            <div class="col-lg-9 col-md-8 col-12 py-2 overflow-hidden">
              <h2 [@slideDown]="overviewVisible ? 'visible' : 'void'"
                appAnimateOnVisible (visible)="overviewVisible = true">
                {{ personDetails?.name }}
              </h2>
              <p class="py-2" >
                {{ showFullBiography ? personDetails?.biography : (personDetails?.biography | seeMore:50) }}
                @if (shouldShowToggle(personDetails?.biography)) {
                  <a
                    class="text-primary ms-2" role="button"
                    (click)="toggleBiography()">
                    {{ showFullBiography ? 'See Less' : 'See More' }}
                  </a>
                }
              </p>
              <h4>Birthday:</h4><p> {{ personDetails?.birthday | date:'longDate' }}</p>
              <h4 [@slideUp]="overviewVisible ? 'visible' : 'void'"
                appAnimateOnVisible (visible)="overviewVisible = true">
                Place of Birth:</h4><p> {{ personDetails?.place_of_birth }}</p>
              </div>
            </div>
          </div>
        }

        <!-- Images Section -->
        @if (personImages) {
          <div class=" my-3 overflow-hidden">
            <h3 [@slideDown]="overviewVisible ? 'visible' : 'void'"
              appAnimateOnVisible (visible)="overviewVisible = true"
              class="py-2"><i class="fa-solid fa-camera fa-1x"></i> Images</h3>
              <div class="w-100 d-flex justify-content-center flex-wrap gap-3 py-3">
                @for (image of visibleImages; track trackByFn($index, image)) {
                  <img [src]="'https://image.tmdb.org/t/p/w500' + image.file_path"
                    width="100"  alt="Image" class="img-fluid rounded-3">
                  }
                </div>
                @if (personImages.length > 10) {
                  <div class="text-center py-2">
                    <button class="text-white px-2 py-1 button-mix-color" (click)="toggleImagesView()">
                      {{ showAllImages ? 'See Less' : 'See More' }}
                    </button>
                  </div>
                }
              </div>
            }
            <!-- person Credits Section -->
            <div class=" py-3 overflow-hidden">
              <h3 [@slideDown]="overviewVisible ? 'visible' : 'void'"
                appAnimateOnVisible (visible)="overviewVisible = true">
                <i class="fa-solid fa-play fa-1x"></i> Movies & TV Shows
              </h3>
            </div>

            <!-- swiper container with ViewChild ref -->
            <div @slideUp class="swiper position-relative" #swiperContainer>
              <div class="swiper-navigation">
                <button class="swiper-button-prev custom-prev">

                </button>
                <button class="swiper-button-next custom-next">
                </button>
              </div>
              <div class="swiper-wrapper">
                @for (mediaPerson of personCredits;track trackMediaPerson($index, mediaPerson); let i = $index) {
                  @if (mediaPerson.poster_path&& mediaPerson.first_air_date || mediaPerson.poster_path&&mediaPerson.release_date) {
                    <div
                      (click)="goToMediaDetails(mediaPerson.media_type ,mediaPerson.id)"
                      class="swiper-slide slider-container rounded-3">
                      <div class="position-relative">
                        @if (mediaPerson.profile_path) {
                          <img 
                            [src]="'https://image.tmdb.org/t/p/w500' + mediaPerson.profile_path" class="rounded-3"
                             alt="Person Image" />
                          }
                          @if (mediaPerson.poster_path) {
                            <img 
                              [src]="'https://image.tmdb.org/t/p/w500' + mediaPerson.poster_path"
                              class="rounded-3" alt="mediaPerson Poster" />
                            }
                            @if (mediaPerson.vote_average) {
                              <button class="vote p-1 rounded-3 border-0 fw-bolder text-white position-absolute top-0 end-0">
                                {{ mediaPerson.vote_average }}
                              </button>
                            }
                          </div>
                          @if (mediaPerson.name) {
                            <p>{{ mediaPerson.name | seeMore:1 }}</p>
                          }
                          @if (mediaPerson.title) {
                            <p>{{ mediaPerson.title | seeMore:1 }}</p>
                          }
                          @if (mediaPerson.release_date) {
                            <p><span class="date-media"><i class="fa-solid fa-clock text-white"></i> {{ mediaPerson.release_date|timeAgo}}</span></p>
                          }
                          @if (mediaPerson.first_air_date) {
                            <p><span class="date-media"><i class="fa-solid fa-clock text-white"></i> {{ mediaPerson.first_air_date|timeAgo}}</span></p>
                          }
                        </div>
                      }
                    }
                  </div>
                </div>


              </div>
            </section>
